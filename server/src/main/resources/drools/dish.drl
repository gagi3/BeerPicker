package drools;
import rs.beerpicker.server.model.*
import rs.beerpicker.server.service.abstraction.*
import java.util.List
import java.util.ArrayList
import java.util.Arrays
dialect  "mvel"

// TYPES

rule "dessert"
salience 2
    when
        $beer: Beer(strength > 5)
        $dish: Dish(type == DishType.DESSERT)
    then
        delete($beer);
end

rule "soup"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER || strength > 4.5)
        $dish: Dish(type == DishType.SOUP)
    then
        delete($beer);
end

rule "salad"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER, style != BeerStyle.WHEAT)
        $dish: Dish(type == DishType.SALAD)
    then
        delete($beer);
end

// INDEXES

rule "sweet"
salience 2
    when
        $beer: Beer(type != BeerType.STOUT , style != BeerStyle.DARK , flavours not contains BeerFlavour.FRUIT)
        $dish: Dish(sweetnessIndex > 3)
    then
        delete($beer);
end

rule "spicy"
salience 2
    when
        $beer: Beer((type != BeerType.ALE || style != BeerStyle.AMBER) , type != BeerType.LAGER)
        $dish: Dish(spicinessIndex > 2)
    then
        delete($beer);
end

rule "hot"
salience 2
    when
        $beer: Beer((type != BeerType.ALE || style != BeerStyle.PALE) , style != BeerStyle.IPA)
        $dish: Dish(spicinessIndex > 4)
    then
        delete($beer);
end

rule "salty"
salience 2
    when
        $beer: Beer(style != BeerStyle.IPA , type != BeerType.STOUT)
        $dish: Dish(saltinessIndex > 3)
    then
        delete($beer);
end

// CUISINES

rule "mexican"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER)
        $dish: Dish(cuisine == Cuisine.MEXICAN)
    then
        delete($beer);
end

rule "american"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER , style != BeerStyle.IPA)
        $dish: Dish(cuisine == Cuisine.AMERICAN)
    then
        delete($beer);
end

rule "german"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER , style != BeerStyle.WHEAT , style != BeerStyle.DARK)
        $dish: Dish(cuisine == Cuisine.GERMAN)
    then
        delete($beer);
end

rule "indian"
salience 2
    when
        $beer: Beer(style != BeerStyle.IPA)
        $dish: Dish(cuisine == Cuisine.INDIAN)
    then
        delete($beer);
end

rule "english"
salience 2
    when
        $beer: Beer(type != BeerType.STOUT)
        $dish: Dish(cuisine == Cuisine.ENGLISH)
    then
        delete($beer);
end

rule "irish"
salience 2
    when
        $beer: Beer(type != BeerType.STOUT , style != BeerStyle.STRONG , style != BeerStyle.DARK , style != BeerStyle.CREAM)
        $dish: Dish(cuisine == Cuisine.IRISH)
    then
        delete($beer);
end

rule "french"
salience 2
    when
        $beer: Beer(style != BeerStyle.AMBER , style != BeerStyle.RED , style != BeerStyle.BLONDE)
        $dish: Dish(cuisine == Cuisine.FRENCH)
    then
        delete($beer);
end

rule "serbian"
salience 2
    when
        $beer: Beer(style != BeerStyle.WHEAT , type != BeerType.LAGER , style != BeerStyle.BLONDE)
        $dish: Dish(cuisine == Cuisine.SERBIAN)
    then
        delete($beer);
end

rule "fried"
salience 2
    when
        $beer: Beer(style != BeerStyle.BLONDE , type != BeerType.LAGER)
        $dish: Dish(preparation contains Preparation.FRYING)
    then
        delete($beer);
end

rule "grilled"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER , type != BeerType.STOUT)
        $dish: Dish(preparation contains Preparation.SMOKING)
    then
        delete($beer);
end

rule "baked"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER)
        $dish: Dish(preparation contains Preparation.BAKING)
    then
        delete($beer);
end

rule "broiled"
salience 2
    when
        $beer: Beer(type != BeerType.LAGER , type != BeerType.STOUT)
        $dish: Dish(preparation contains Preparation.BROILING)
    then
        delete($beer);
end

rule "roasted"
salience 2
    when
        $beer: Beer(type != BeerType.STOUT)
        $dish: Dish(preparation contains Preparation.ROASTING)
    then
        delete($beer);
end

// QUERY

query getBeers
    $beer: Beer()
end